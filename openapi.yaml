openapi: 3.1.0
info:
  title: F1 Statistics API
  version: 1.1.0
  description: |
    REST API pro získávání statistik Formule 1.
    API používá path parametry a query parametry v souladu s REST standardy.

servers:
  - url: http://127.0.0.1:8088
    description: Lokální vývojový server

paths:
  /api/v1/stats/drivers/{surname}:
    get:
      summary: Získání informací o jezdci
      parameters:
        - name: surname
          in: path
          required: true
          description: Příjmení jezdce
          schema:
            type: string
            example: Alonso
      responses:
        "200":
          description: Informace o jezdci
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Driver'
        "404":
          description: Jezdec nenalezen

  /api/v1/stats/seasons:
    get:
      summary: Získání všech sezón
      responses:
        "200":
          description: Seznam sezón
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  example: "2004"

  /api/v1/stats/seasons/{season}/races:
    get:
      summary: Získání závodů v sezóně
      parameters:
        - name: season
          in: path
          required: true
          description: Rok sezóny
          schema:
            type: integer
            example: 2004
      responses:
        "200":
          description: Seznam závodů
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: '#/components/schemas/Race'

  /api/v1/stats/seasons/{season}/races/{round}/results:
    get:
      summary: Výsledky konkrétního závodu
      parameters:
        - name: season
          in: path
          required: true
          schema:
            type: integer
            example: 2004
        - name: round
          in: path
          required: true
          schema:
            type: integer
            example: 2
      responses:
        "200":
          description: Výsledky závodu
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: '#/components/schemas/RaceResult'

  /api/v1/stats/seasons/{season}/championships/drivers:
    get:
      summary: Průběžné pořadí jezdců
      parameters:
        - name: season
          in: path
          required: true
          schema:
            type: integer
            example: 2006
        - name: round
          in: query
          required: false
          description: Kolo sezóny (pokud není zadáno, použije se poslední)
          schema:
            type: integer
            example: 4
      responses:
        "200":
          description: Body jezdců
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: '#/components/schemas/DriverChampionship'

  /api/v1/stats/seasons/{season}/championships/constructors:
    get:
      summary: Průběžné pořadí konstruktérů
      parameters:
        - name: season
          in: path
          required: true
          schema:
            type: integer
            example: 2006
        - name: round
          in: query
          required: false
          description: Kolo sezóny (pokud není zadáno, použije se poslední)
          schema:
            type: integer
            example: 4
      responses:
        "200":
          description: Body konstruktérů
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  $ref: '#/components/schemas/ConstructorChampionship'

  /api/v1/stats/seasons/races/active/hook:
    post:
      summary: Registrace webhooku
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebhookRequest'
      responses:
        "200":
          description: Webhook úspěšně zaregistrován
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true

  /dev/hooks:
    post:
      summary: Testovací webhook endpoint
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Webhook přijat
          content:
            text/plain:
              schema:
                type: string
                example: Accepted

components:
  schemas:
    Driver:
      type: object
      properties:
        driverId:
          type: string
        driverRef:
          type: string
        number:
          type: string
        code:
          type: string
        forename:
          type: string
        surname:
          type: string
        dob:
          type: string
          format: date
        nationality:
          type: string
        url:
          type: string

    Race:
      type: object
      properties:
        name:
          type: string
          example: Australian Grand Prix
        date:
          type: string
          format: date
          example: "2004-03-07"

    RaceResult:
      type: object
      properties:
        driver:
          type: string
          example: Alonso
        constructor:
          type: string
          example: Renault
        grid:
          type: string
          example: "1"

    DriverChampionship:
      type: object
      properties:
        driver:
          type: string
          example: Alonso
        points:
          type: string
          example: "36"
        wins:
          type: string
          example: "2"

    ConstructorChampionship:
      type: object
      properties:
        driver:
          type: string
          example: Renault
        points:
          type: string
          example: "51"
        wins:
          type: string
          example: "3"

    WebhookRequest:
      type: object
      required:
        - callbackUrl
        - season
        - round
      properties:
        callbackUrl:
          type: string
          format: uri
        season:
          type: integer
        round:
          type: integer
